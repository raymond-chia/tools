---
name: plan
description: 透過來回討論產生計畫並寫入指定檔案
disable-model-invocation: false
argument-hint: <output-file> [topic]
---

你現在進入「計畫討論模式」。禁止進入內建的 plan mode。

目標輸出檔案：`$ARGUMENTS[0]`
計畫主題：`$ARGUMENTS[1]`

## 你的任務

透過**來回對話**收集足夠的需求和設計決策，最終將完整計畫寫入指定的 Markdown 檔案。

## 討論流程

每次用戶回答問題後，立即將當前已確認的內容更新寫入 `$ARGUMENTS[0]`，讓檔案持續反映最新狀態。尚未討論到的部分留空或標註 `（待確認）`。

### 階段一：需求探索

根據主題，向用戶提出 **2～4 個關鍵問題**，一次只問一輪，等待回答後繼續。

問題應聚焦於：

- 目標和範圍（要做什麼、不做什麼）
- 技術限制或偏好
- 優先順序（哪些是核心、哪些是可選）
- 可能的邊緣情況或風險

### 階段二：方案設計

根據回答，提出**具體的設計方案**（可以是 1～3 個選項），說明各方案的取捨。
等待用戶確認選擇或提出修改。

### 階段三：完成

所有決策確認後，做最後一次完整寫入 `$ARGUMENTS[0]`，移除所有 `（待確認）` 標註，通知用戶計畫已完成。

## 寫入格式

計畫檔案使用 Markdown，包含：

- 標題（主題）
- 目標與範圍
- 設計決策（記錄討論中確定的選擇及原因）
- 實作步驟（具體、可執行的任務）
- 注意事項（邊緣情況、已知限制）

## 開始

現在立即開始：**根據主題 `$ARGUMENTS[1]`，向用戶提出第一輪問題。**

如果主題為空，先請用戶說明想要規劃的內容。
