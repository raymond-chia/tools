# 通用規則

- [ ] **語言**: 繁體中文（註解、文件），禁止簡體中文
  - ⚠️ **所有回應禁止簡體中文**
- [ ] 使用 match 而不要 let else
- [ ] match arm 使用編譯器的 exhaustiveness checking 保護，避免未來忘記添加 match arm
- [ ] **確保型別安全**
- [ ] **有完整錯誤處理**（錯誤訊息包含豐富上下文）
- [ ] **禁止 magic numbers/strings**
- [ ] **變數命名**：使用有辨識度的名稱，避免相似的縮寫（例如同一作用域內不要同時使用 `attr` 和 `attribute`）
- [ ] **優先使用 alias**：優先使用 `core/board/src/alias.rs` 中定義的類型別名（如 `Coord`、`MovementCost`、`ID`、`TypeName`、`SkillName`），不直接使用原始型別（`usize`、`u32`、`String`）。這提升代碼語義清晰度。
- [ ] **Fail fast**：在函數開頭進行所有驗證和檢查，不在執行中間檢查
- [ ] **不要預先設計**：只補現在用到的 derive、方法、錯誤類型
  - 只補齊必要的 derive，不嘗試預先 derive
  - 有需要時再添加，不要預測未來需求
- [ ] **優先 derive，不手動實現**：除非某個 trait 無法 derive，否則總是使用 derive（如 Default、Clone、Debug、Copy 等）
- 每當 claude code 提出設計建議時，要求 claude code 先明確引用 CLAUDE.md 的具體條文來論證為什麼這個設計符合規則
- 撰寫計畫的時候不要添加程式碼，請保持精簡
- `use` 語句放在檔案頂部，不要放在 function 裡面

## **技術判斷原則**

- **優先驗證而非同意**
  - 對技術建議必須驗證（測試、推導、實驗），不盲目同意
  - 即使用戶提出建議，也要確認其正確性才認可

- **明確表達確定性等級**
  - ✅ **確定**：已驗證過、有測試或推導支撐
  - ⚠️ **可能**：邏輯上合理但未驗證，需要測試
  - ❌ **不確定**：無法判斷，應說「我不清楚，需要驗證」

- **避免過度同意**
  - 不因為用戶同意就改變已驗證的結論
  - 不因為用戶提出就馬上認可，而不驗證
  - 區分「這在理論上可能」與「這確實有效」

- **質疑時的標準**
  - 對優化建議：必須寫代碼驗證，運行測試
  - 對邏輯主張：必須詳細推導，考慮邊界情況
  - 對設計決定：必須引用 CLAUDE.md 或已驗證的原則

- **不確定時的做法**
  - 明確說「我不能確認」或「需要驗證」
  - 建議：「讓我們寫測試驗證」或「讓我詳細推導」
  - 不承諾已驗證但其實沒有的優化

# 本專案

- 本專案是戰術回合制 RPG 遊戲（Rust）
- 禁止向後相容
- 使用 functional programming
  - 禁止使用 oop
- 寫完後檢查是否有違反 D:\Mega\prog\rust\tools\README-設計機制.md。如果只是尚未實作完畢，只要提示尚未實作就好。如果違反請警告使用者
